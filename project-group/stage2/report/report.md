---
## Front matter
title: "Моделирование образования планетной системы"
subtitle: "Этап 2"
author: "Матюхин Г.В. и Генералов Д.М."

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Теоретическое описание задачи

Газопылевое облако, из которого позднее образовались планеты и Солнце на-
шей Солнечной системы, имело ненулевой момент импульса, то есть вращалось.
Известно, что суммарный момент импульса в замкнутой системе сохраняется.
По мере гравитационного сжатия газопылевого облака расстояние всех его ча-
стей от оси вращения сокращалось и скорость вращения сгущающегося облака
увеличивалась. Очевидно, что в плоскости, перпендикулярной оси вращения,
сжатие происходило медленнее. Поэтому облако, бывшее изначально шаровид-
ным, становилось все более плоским. Из-за гравитационной неустойчивости на
периферии формирующегося диска отделилось кольцо вещества. Оставшееся об-
лако продолжало сжиматься и вращаться еще быстрее. Затем от него отделилось
новое кольцо вещества. Позднее кольца вещества сгустились в планеты.

# Физические параметры задачи

Мы будем симулировать кинематику частиц, подверженных гравитационному воздействию.
Движение частиц можно записать в форме дифференциального уравнения, но такое дифференциальное уравнение не будет иметь решения:
в общем случае задача об N телах может быть решена только численными методами.

В случае, когда количество тел фиксированное, можно использовать стандартный решатель дифференциальных уравнений с большим количеством аргументов.
Стандартные решатели имеют хорошую численную стабильность и производительность: 
например, метод Ch. Tsitouras [@tsit5] 
динамически меняет размер шага интеграции, чтобы большинство измерений происходили в той области функции, где ее поведение наиболее нелинейное.

Однако в нашей задаче количество параметров (координаты и скорости частиц) не только очень высокое, но также может меняться со временем:
две частицы могут превратиться в одну.
Это нельзя симулировать, как будто бы две частицы занимли одинаковое пространство,
потому что при приближении частиц сила гравитации между ними сильно увеличивается,
и если частицы могли бы проходить сквозь друг друга, то они могли бы выполнять gravity assist друг от друга в любой момент, когда появляется численная нестабильность.

С учетом этих особенностей, мы решаем реализовать свой собственный алгоритм интеграции,
который основан на классическом методе Эйлера:

- Начинаем с случайных позиций частиц в орбите вокруг общего центра и их скоростей;
- На каждом шаге, перебираем все частицы, и для каждой -- всех ее соседей; вычисляем суммарную силу тяготения;
- Если эта частица находится от другой частицы на расстоянии, меньшем, чем сумма радиусов, то добавляем силу отталкивания;
- В зависимости от суммарной силы считаем новую скорость для частицы;
- Двигаем частицу на один шаг времени по вектору скорости;
- Если две частицы должны слипнуться, то удаляем эти две и создаем новую с общими параметрами радиуса, массы и скорости.


Поскольку нам неизвестна жесткость этой системы дифференциальных, мы должны использовать сравнительно малый шаг интеграции.
Это не слишком оптимально, но, в случае необходимости, это можно оптимизировать похожим способом на стандартные алгоритмы:
если сила, действующая на одну частицу, маленькая, то эта частица может не участовать в следующем шаге симуляции,
потому что ее движение в этот момент времени остается примерно прямолинейным.

На различных этапах стоит проверять, что сумма потенциальных энергий частиц остается одинаковой между двумя моментами времени, между которыми не было столкновений.
Это -- инвариант задачи, и нарушение его может означать, что в симуляции есть ошибка. 

# Реализация

Для симуляции потребуется сравнительно высокое количество вычислений, поэтому для этого лучше всего использовать языки программирования, которые компилируются в машинный код. Для этого проекта мы будем использовать Rust, который известен производительностью и легкостью выполнения надежных параллельных вычислений.
В случае недостаточной скорости можно также использовать GPU-вычисления, основанные на compute-шейдерах: это может дать значительное ускорение, потому что вычисления для каждой частицы независимы от вычислений для всех остальных частиц, и поэтому хорошо подвергаются параллельному вычислению.

Критерием остановки симуляции может быть прохождение какого-то времени без столкновений и слипаний. Это говорит о том, что солнечная система смогла стать полностью стабилизированной; тогда можно определить метрики вроде количества образовавшихся планет и того, какие из них находятся в обитаемой зоне от звезды.
Визуализация должна быть настроена так, чтобы центр массы оставался в одном месте:
возможно так, что коллективный момент всех частиц приведет к смещению этого центра массы и к тому, что все частицы вместе начнут двигаться от центра координат.

Для визуализации можно использовать обычные библиотеки для рисования графиков, вроде matplotlib, но это может быть сложным, особенно для визуализации динамической эволюции системы. Тогда можно использовать инструменты вроде Blender для рендера анимаций, или GUI-инструменты вроде Pygame, которые могут выдавать анимацию по входным данным в реальном времени.

# Выводы

Мы можем решить задачу моделирования образования солнечной системы,
используя довольно простые алгоритмы численного моделирования.
Отслеживая позиции и моменты частиц, и позволяя им соединяться в единые частицы,
мы можем определить перспективы развития солнечной системы
из плоского протопланетарного диска.
Это можно отобразить на анимациях,
и делать анализ различных запусков для определения закономерностей.

# Список литературы{.unnumbered}

::: {#refs}
:::
