---
## Front matter
title: "Моделирование образования планетной системы"
subtitle: "Этап 4"
author: "Матюхин Г. В. и Генералов Д. М."

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Провести моделирование одного из этапов эволюции Вселенной -- образование некой "солнечной" системы из межзвездного газа.

# Выполнение

Весь код, который был написан в этой работе, можно увидеть по ссылке: https://github.com/danya02/study_2023-2024_mathmod/tree/master/project-group/stage4

## Симуляция

После ускорения вычисляющего кода посредством выбора языка Rust,
мы смогли провести несколько симуляций с большим числом частиц.

Симуляции проводились в много небольших шагов, чтобы можно было восстановить вычисление после сбоя.
Чаще всего сбои происходили из-за нехватки оперативной памяти:
поскольку программа хранит копию каждого состояния, включая координаты и скорости всех частиц,
то эти данные растут довольно быстро,
даже если большинство частиц склеиваются:
так, уже после 240 шагов времени весь набор данных занимает 9.4ГБ в JSON-формате,
даже для 50000 стартовых частиц.
Учитывая это, мы приняли решение ограничиться количеством около 50000 частиц:
это позволяет держать использование памяти в пределах доступных нам компьютеров,
и при этом даст достаточно полную картину поведения,
потому что большинство частиц склеиваются с другими довольно быстро.

Можно было бы обойти эту проблему, сохраняя лишь текущее и предыдущее состояние системы, однако с полной записью событий мы можем посчитать различные метрики симуляции, вроде потенциальной и кинетической энергии системы, а также скорости склеивания частиц.

У нас получились несколько файлов вывода: 

## Метрики

После того, как мы посчитаем симуляцию, мы хотим найти некоторые показатели симуляции:
например, потенциальную и кинетическую энергию, количество активных частиц и другие параметры.

Попробовав это сделать, мы находим проблемы в коде импорта/экспорта состояния системы, которые приводят к невозможным скачкам, но в целом показывают, что энергия постепенно уменьшается со временем, и это соответствует переходу частиц в единые склееные частицы.  

![Потенциальная и кинетическая энергия (с скачками)](../presentation/image/1.png){#fig:001 width=70%}


## Визуализация

Поскольку гравитационная система с таким большим количеством частиц ведет себя хаотично, мы не можем предсказать финальный размер системы. Помимо этого, некоторые частицы выкидываются за пределы образуемой солнечной системы, и их дальнейшее движение нам неинтересно.

Из-за этого мы используем инструмент, который позволяет нам контролировать специфику визуализации и имеет бесконечную рабочую область: по этим характеристикам мы выбрали Blender.

В предыдущей работе мы указывали, как мы использовали алгоритм Рамера — Дугласа — Пекера для сокращения количества точек в траектории одной частицы -- это позволяет оптимизировать импорт в Blender, потому что количество действий, которые могут быть выполнены через API за одно время, сильно ограничено. Однако, из-за сглаживания кривых, которое происходит в Blender по умолчанию для ключевых точек, получившиеся пути довольно близки к настоящим.

# Выводы

Мы успешно смогли провести симуляцию развития солнечной системы на основании гравитационного взаимодействия и силы тяжести. Наш код может послужить основой для дальнейшего исследования темы. 
